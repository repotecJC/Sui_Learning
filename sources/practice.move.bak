module sui_learning::practice{

    // Common models
    use std::vector;
    use std::string::String;
    use std::option::{Self, Option};

    // Sui models
    use sui::random::{Self, Random};
    // Implicitly imported(import by default) but write it down to remind myself
    use sui::object::{Self, UID};
    use sui::tx_context::{Self, TxContext}; // Transaction context, all kind of the information about the transaction
    use sui::transfer;

    // Define Hero, Sword, Item structs
    struct Hero has key, store{
        id: UID,
        name: String,
        hp: u8,
        sword: Option<Sword>,
        backpack: vector<Item>,
    }
    struct Sword has key, store {
        id: UID,
        durability: u8,
        damage: u8,
    }
    struct Item has store, drop {
        name: String,
        description: String,
        price: u8,
    }
    struct Monster has key, store {
        id: UID,
        name: String,
        hp: u8,
        attack: u8,
    }

    // Define public functions, generate new Hero and Sword
    public fun new_hero(name: String, ctx: &mut TxContext): Hero {
        let id = object::new(ctx);
        let hp = 100;
        let sword = option::none<Sword>();
        let backpack = vector::empty<Item>();

        Hero{
            id,
            name,
            hp,
            sword,
            backpack
        }
    }
    // Define r: &Randon to let the system import the random module
    public fun new_sword(r: &Random, name: String, ctx: &mut TxContext): Sword {

        let g = sui::random::new_random_generator(r, ctx);

        let id = object::new(ctx);
        let durability = random::generate_u8_in_range(&mut g, min:50, max:500);
        let damage = random::generate_u8_in_range(&mut g, min:1, max:1000);

        Sword{
            id,
            name,
            durability,
            damage
        }
    }

    fun equip_sword(hero: &mut Hero, sword: Sword){
        if (option::is_none(hero.sword)){
            option::fill(&mut hero.sword, sword);
        }
        else{
            print("You already have a sword!");
        }
    }

    fun unequip_sword(hero: &mut Hero, sword: Sword){
        if (option::is_some(hero.sword)){
            let old_sword = option::extract(&mut hero.sword);
            // drop old_sword;
            option::delete(&mut hero.sword, old_sword);
        }
        else{
            print("You don't have a sword to unequip!");
        }
    }

    fun auto_generate_monster(r: &Random, ctx: &mut TxContext): Monster {
        
        let g = sui::random::new_random_generator(r, ctx);
        
        let id = object::new(ctx);
        let name = random::string(ctx);
        let hp = random::generate_u8_in_range(&mut g, min:500, max:5000);
        let attack = random::generate_u8_in_range(&mut g, min:30, max:300);

        Monster{
            id,
            name,
            hp,
            attack
        }
    }

    fun attack(hero: &mut Hero, monster: &mut Monster){

    }
}